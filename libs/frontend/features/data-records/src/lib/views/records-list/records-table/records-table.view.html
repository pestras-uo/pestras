<div class="card" *contra="let c">
  <ng-container *ngIf="records$ | async as records">
    <div class="card-body overflow-x-auto">
      <table *ngIf="records.length else noData">
        <thead>
          <tr>
            <th class="w-2">#</th>
            <th *ngFor="let field of fields | arrayFilter: filterFields: (columns$ | async)">
              <pui-table-th [sortable]="field.type | fn: sortable" [key]="field.name" (sort)="onSort($event)">
                {{field.system ? c[field.display_name] : field.display_name}}
              </pui-table-th>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of records; let i = index" class="hover cursor-pointer" (click)="tryVisit(item)">
            <td>{{skip + i + 1}}</td>
            <td *ngFor="let field of fields | arrayFilter: filterFields: (columns$ | async)">
              <app-field-value *ngIf="!preloader"
                [class.success]="field.type === 'datetime' || field.type === 'date'"
                [class.primary]="field.type === 'int' || field.type === 'double'"
                [field]="field"
                [value]="item[field.name]"
                locationAsLink
              ></app-field-value>
            </td>
          </tr>
        </tbody>
      </table>

      <ng-template #noData>
        <no-data-placeholder-widget [small]="true">
          {{c['noDataMsg']}}
        </no-data-placeholder-widget>
      </ng-template>
    </div>

    <div *ngIf="records.length" class="card-footer">
      <div class="grow"></div>
      <pui-table-pagination
        [count]="count"
        [pageSize]="pageSize"
        (selects)="page$.next($event)"
      ></pui-table-pagination>
      <div class="grow"></div>
    </div>
  </ng-container>

  <pui-preloader *ngIf="preloader"></pui-preloader>
</div>
